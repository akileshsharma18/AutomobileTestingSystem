<html>
    <head>
        <title>TESTIFICATION</title>
        <!-- CSS -->
            <!-- Font Awesome -->
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
            <!-- Bootstrap core CSS -->
            <link href="css/bootstrap.min.css" rel="stylesheet">
            <!-- Material Design Bootstrap -->
            <link href="css/mdb.min.css" rel="stylesheet">
            <!-- Google Fonts -->
            <link href='https://fonts.googleapis.com/css?family=Amiko' rel='stylesheet'>
            <!-- Custom Files -->
            <link rel="stylesheet" href="css/style.css">
        
        <!-- Scripts -->
            <!-- JQuery -->
            <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
            <!-- Bootstrap tooltips -->
            <script type="text/javascript" src="js/popper.min.js"></script>
            <!-- Bootstrap core JavaScript -->
            <script type="text/javascript" src="js/bootstrap.min.js"></script>
            <!-- MDB core JavaScript -->
            <script type="text/javascript" src="js/mdb.min.js"></script>
        
        <script type="text/javascript">

           //Created / Generates the captcha function    
            function DrawCaptcha()
            {
                var a = Math.ceil(Math.random() * 10)+ '';
                var b = Math.ceil(Math.random() * 10)+ '';       
                var c = Math.ceil(Math.random() * 10)+ '';  
                var d = Math.ceil(Math.random() * 10)+ '';  
                var e = Math.ceil(Math.random() * 10)+ '';  
                var f = Math.ceil(Math.random() * 10)+ '';  
                var g = Math.ceil(Math.random() * 10)+ '';  
                var code = a + ' ' + b + ' ' + ' ' + c + ' ' + d + ' ' + e + ' '+ f + ' ' + g;
                document.getElementById("txtCaptcha").value = code
            }

            // Validate the Entered input aganist the generated security code function   
            function ValidCaptcha(){
                var str1 = removeSpaces(document.getElementById('txtCaptcha').value);
                var str2 = removeSpaces(document.getElementById('txtInput').value);
                var button = document.getElementById('butt');
                if (str1 == str2){
                    button.style.display = 'block';
                    return true;
                } 
                
                          
                return false;

            }

            // Remove the spaces from the entered and generated code
            function removeSpaces(string)
            {
                return string.split(' ').join('');
            }

            obj =
                {
                    xhr: new XMLHttpRequest(), 
                    
                    monitor: function()
                    {
                        var id1 = document.getElementById("emailid").value;
                        this.xhr.onreadystatechange = this.update;
                        
                        this.xhr.open("GET", "getquestion.php?id="+id1, true);
                        this.xhr.send();
                    },
                    
                    update: function()
                    {
                        if(this.readyState == 4 && this.status == 200)
                        {
                                console.log(this);
                                document.getElementById("question").value = this.responseText;
                                //this.abort();
                                //obj.monitor();
                        }
                    }
}


        </script>

    </head>
    
    <body class="body_style" onload="DrawCaptcha();">

        <main>
            <div class="container">
                <br><br>
                <center>
                    <h1>
                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xs-12">
                            <center>
                                FORGOT YOUR PASSWORD?
                                <br>
                            </center>
                        </div>    
                    </h1>
                </center>
                
                <form class="text" style="color: #757575;" action="forgotpass.php" method="POST">
                    
                    <center>
                        
                        <h3>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xs-12">
                                <center>
                                    RESET HERE.
                                </center>
                            </div>    
                        </h3>
                        <br><br>
                        <div class="md-row mb-4">
                            <!-- SPACE FOR PHP CODE TO TAKE QUESTIO FROM DB -->
                            
                            <!-- ANSWER -->
                            <div class="md-form">
                                <input type="email" id="emailid" name="emailid" class="form-control" onblur = "obj.monitor()" required>
                                <label for="form1">E-MAIL</label>
                            </div>

                            <!-- ANSWER -->
                            <div class="md-form">
                                <input type="text" id="question" class="form-control" value = "" required>
                                <label for="form1">QUESTION</label>
                            </div>
                            
                            <!-- ANSWER -->
                            <div class="md-form">
                                <input type="text" id="answer" name="answer" class="form-control" required>
                                <label for="form1">ANSWER</label>
                            </div>

                            <!-- New Password -->
                            <div class="md-form">
                                    <input type="password" id="pass" name="pass" class="form-control" required>
                                    <label for="form1">New Password</label>
                                </div>
                            <!-- Confirm Password -->
                            <div class="md-form">
                                    <input type="password" id="cpass" name="cpass" class="form-control" required>
                                    <label for="form1">Confirm Password</label>
                                </div>    
                        </div>
                    </center>
                    <br><br>
                    
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-3">
                        <input type="text" id="txtCaptcha" 
                               style="background-image:url(images/1.JPG); text-align:center; border:none;
                                      font-weight:bold; font-family:Modern; height: 8%; " />

                        <br><br>
                        
                        <button class="btn btn-primary btn-rounded btn-block" type="button"
                                id="btnrefresh" value="Refresh" onclick="DrawCaptcha();">
                            REFRESH
                        </button>
                    </div>
                    
                    

                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-3">
                        <div class="md-form">
                            <input type="text" id="txtInput" class="form-control" required>
                            <label for="txtInput">ENTER CAPTCHA</label>
                        </div>
                    </div> 
                    
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-3">
                        <button class="btn btn-primary btn-rounded btn-block" type="button"
                                value="Check" onclick="ValidCaptcha();">
                            VALIDATE
                        </button>
                    </div> 
                    
                    <br><br>
                    <input class="btn btn-primary btn-rounded btn-block button1" id = "butt" style="display: none;" value="RESET PASSWORD" type="submit"/>
                </form>
                
            </div>
        </main>
    </body>
</html>